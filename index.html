<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Sistem Perwalian Siswa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{
      font-family:Segoe UI, Arial, sans-serif;
      background:#f1f2f6;
      margin:0;
    }
    header{
      background:#1e3799;
      color:#fff;
      padding:16px 20px;
    }
    header h1{margin:0;font-size:20px}
    header p{margin:4px 0 0;font-size:13px}

    .container{max-width:1100px;margin:auto;padding:20px}
    .card{
      background:#fff;
      border-radius:8px;
      padding:20px;
      box-shadow:0 2px 6px rgba(0,0,0,.08);
      margin-bottom:20px
    }
    h3{margin-top:0}

    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{padding:10px;border-bottom:1px solid #eee}
    th{background:#dfe4ea;text-align:left}
    tr:hover{background:#f8f9fa}
    a{color:#1e3799;text-decoration:none;font-weight:600}

    label{font-size:13px;font-weight:600}
    input,select,textarea{
      width:100%;
      padding:8px;
      margin-top:4px;
      border:1px solid #ccc;
      border-radius:4px
    }
    textarea{resize:vertical}
    button{
      background:#1e3799;
      color:#fff;
      border:none;
      padding:10px 16px;
      border-radius:6px;
      cursor:pointer;
      margin-top:10px
    }
    button:hover{opacity:.9}

    footer{text-align:center;font-size:12px;color:#777;padding:15px}
  </style>
</head>
<body>

<header>
  <h1>Sistem Perwalian Siswa</h1>
  <p>Login Wali Kelas & BK | Google Sheet Backend</p>
</header>

<div class="container">

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h3>Login Pengguna</h3>
  <label>Email</label>
  <input id="email">
  <label>Password</label>
  <input id="password" type="password">
  <button onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div class="card" id="dashboard" style="display:none">
  <h3>Data Siswa</h3>
  <table id="tabel">
    <thead>
      <tr>
        <th>NIS</th>
        <th>Nama</th>
        <th>Status</th>
        <th>Catatan</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- FORM -->
<div class="card" id="formBox" style="display:none">
  <h3>Form Perwalian</h3>
  <label>Nama Siswa</label>
  <input id="nama" readonly>

  <label>Status Pembinaan</label>
  <select id="status">
    <option>Baik</option>
    <option>Pembinaan</option>
    <option>Perhatian Khusus</option>
  </select>

  <label>Catatan Wali Kelas / BK</label>
  <textarea id="catatan" rows="4"></textarea>

  <button onclick="simpan()">Simpan Perwalian</button>
</div>

</div>

<footer>
  Â© 2026 Sistem Perwalian Siswa | Frontend GitHub Pages
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx0JKgruxbT6DfYVzPukr5G2yIcn1gZzi5AZgL58i2JHaaowVHWYH4lG0Mw6W86unJqzA/exec";

const siswa = [
  {nis:"252610021",nama:"AI FITRI NURAENI"},
  {nis:"252610022",nama:"ANWAR MUTAQIN"},
  {nis:"252610023",nama:"AYYISY MAULIDA ISNAENI"},
  {nis:"252610024",nama:"DEDE NURUL ALAMSAH"}
];

let aktif = null;

function login(){
 fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({
    email:email.value,
    password:password.value
  })
 }).then(r=>r.json()).then(res=>{
  if(res.status=="success"){
    loginBox.style.display="none";
    dashboard.style.display="block";
    formBox.style.display="block";
    render();
  } else alert("Login gagal");
 });
}

function render(){
 const tb=document.querySelector('#tabel tbody');
 tb.innerHTML='';
 siswa.forEach((s,i)=>{
  const tr=document.createElement('tr');
  tr.innerHTML=`
   <td>${s.nis}</td>
   <td><a href="#" onclick="pilih(${i})">${s.nama}</a></td>
   <td>${s.status||'-'}</td>
   <td>${s.catatan||'-'}</td>`;
  tb.appendChild(tr);
 });
}

function pilih(i){
 aktif=i;
 nama.value=siswa[i].nama;
 status.value=siswa[i].status||'Baik';
 catatan.value=siswa[i].catatan||'';
}

function simpan(){
 if(aktif===null){alert('Pilih siswa');return;}
 siswa[aktif].status=status.value;
 siswa[aktif].catatan=catatan.value;

 fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({
    action:"simpan",
    nis:siswa[aktif].nis,
    nama:siswa[aktif].nama,
    status:status.value,
    catatan:catatan.value
  })
 });

 render();
 alert('Data tersimpan');
}
</script>

</body>
</html>
